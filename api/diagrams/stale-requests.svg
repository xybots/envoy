<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="619" height="460"><source><![CDATA[participant Envoy as E [color="black"]
participant Management Server as M [color="black"]

E->M: (V=X,R={foo},N=A,T=EDS) [color="green"]
Note right of M: Stale
E->M: (V=X,R={foo,bar},N=A,T=EDS) [color="green"]
M->E: (V=Y,R={foo:...,bar:...},N=B,T=EDS) [color="gray"]
E->M: (V=X,R={foo,baz},N=A,T=EDS) [color="green"]
Note right of M: Stale
E->M: (V=Y,R={foo,baz},N=B,T=EDS) [color="green"]
M->E: (V=Z,R={foo:...,baz:...},N=C,T=EDS) [color="gray"]]]></source><desc style="-webkit-tap-highlight-color:transparent">Created with RaphaÃ«l 2.2.0</desc><defs style="-webkit-tap-highlight-color:transparent"><path id="raphael-marker-block" stroke-linecap="round" d="M5,0 0,2.5 5,5z" style="-webkit-tap-highlight-color:transparent"/><marker id="raphael-marker-endblock55-obj9nxqj" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="green" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objk90nb" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="green" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objfy5rz" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objo7xf5" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="green" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objml2fb" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="green" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-obj2ezld" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker></defs><rect width="68" height="38" x="10" y="20" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="48" height="18" x="19.984" y="30" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="44" y="39" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Envoy</tspan></text><rect width="68" height="38" x="10" y="402" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="48" height="18" x="19.984" y="412" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="44" y="421" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Envoy</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M44,58L44,402" style="-webkit-tap-highlight-color:transparent"/><rect width="183.219" height="38" x="308.438" y="20" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="163.219" height="18" x="318.422" y="30" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="400.047" y="39" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Management Server</tspan></text><rect width="183.219" height="38" x="308.438" y="402" fill="#fff" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="163.219" height="18" x="318.422" y="412" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="400.047" y="421" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Management Server</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M400.046875,58L400.046875,402" style="-webkit-tap-highlight-color:transparent"/><rect width="220.828" height="18" x="111.594" y="74" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="222.023" y="83" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">(V=X,R={foo},N=A,T=EDS)</tspan></text><path fill="none" stroke="green" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj9nxqj)" d="M44,96C44,96,351.8996730474755,96,395.04772293254655,96" style="-webkit-tap-highlight-color:transparent"/><rect width="58" height="28" x="420.047" y="116" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="48" height="18" x="425.031" y="121" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="449.047" y="130" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Stale</tspan></text><rect width="259.234" height="18" x="92.391" y="160" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="222.023" y="169" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">(V=X,R={foo,bar},N=A,T=EDS)</tspan></text><path fill="none" stroke="green" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objk90nb)" d="M44,182C44,182,351.8996730474755,182,395.04772293254655,182" style="-webkit-tap-highlight-color:transparent"/><rect width="336.047" height="18" x="53.984" y="198" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="222.023" y="207" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">(V=Y,R={foo:...,bar:...},N=B,T=EDS)</tspan></text><path fill="none" stroke="gray" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objfy5rz)" d="M400.046875,220C400.046875,220,92.14720195252448,220,48.99915206745345,220" style="-webkit-tap-highlight-color:transparent"/><rect width="259.234" height="18" x="92.391" y="236" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="222.023" y="245" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">(V=X,R={foo,baz},N=A,T=EDS)</tspan></text><path fill="none" stroke="green" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objo7xf5)" d="M44,258C44,258,351.8996730474755,258,395.04772293254655,258" style="-webkit-tap-highlight-color:transparent"/><rect width="58" height="28" x="420.047" y="278" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="48" height="18" x="425.031" y="283" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="449.047" y="292" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Stale</tspan></text><rect width="259.234" height="18" x="92.391" y="322" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="222.023" y="331" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">(V=Y,R={foo,baz},N=B,T=EDS)</tspan></text><path fill="none" stroke="green" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objml2fb)" d="M44,344C44,344,351.8996730474755,344,395.04772293254655,344" style="-webkit-tap-highlight-color:transparent"/><rect width="336.047" height="18" x="53.984" y="360" fill="#fff" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="222.023" y="369" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">(V=Z,R={foo:...,baz:...},N=C,T=EDS)</tspan></text><path fill="none" stroke="gray" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj2ezld)" d="M400.046875,382C400.046875,382,92.14720195252448,382,48.99915206745345,382" style="-webkit-tap-highlight-color:transparent"/></svg>